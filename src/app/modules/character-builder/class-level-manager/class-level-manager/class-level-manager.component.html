<mat-tab-group animationDuration="0ms" class="class-manager-tab-group" [(selectedIndex)]="this.selectedIndex">
  <mat-tab label="Class Search">

    <!--      <mat-expansion-panel class="filters-panel">-->

    <!--        <mat-expansion-panel-header>-->
    <!--          <mat-panel-title>-->
    <!--            Filters-->
    <!--          </mat-panel-title>-->
    <!--        </mat-expansion-panel-header>-->

    <!--        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="25px">-->
    <!--        <mat-form-field [color]="'warn'">-->
    <!--          <mat-label>Name filter</mat-label>-->
    <!--          <input matInput [formControl]="nameFilter" autocomplete="off">-->
    <!--        </mat-form-field>-->

    <!--        <mat-form-field [color]="'warn'">-->
    <!--          <mat-label>Source</mat-label>-->
    <!--          <input matInput [formControl]="sourceFilter" autocomplete="off">-->
    <!--        </mat-form-field>-->
    <!--        </div>-->

    <!--        <div>-->
    <!--          <button mat-flat-button color="warn" (click)="clearFilter()">Clear</button>-->
    <!--        </div>-->

    <!--      </mat-expansion-panel>-->

    <table mat-table [dataSource]="searchTableDataSource" matSort>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let characterClass"> {{characterClass.name}} </td>
      </ng-container>

      <ng-container matColumnDef="name-filter">
        <th mat-header-cell *matHeaderCellDef>
          <mat-form-field appearance="fill" color="warn" class="filter">
            <mat-label>Name filter</mat-label>
            <input matInput [formControl]="nameFilter" autocomplete="off">
            <button *ngIf="nameFilter.value" matSuffix mat-icon-button aria-label="Clear" (click)="clearFilter()">
              <mat-icon>close</mat-icon>
            </button>
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="hit-die">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Hit Die</th>
        <td mat-cell *matCellDef="let characterClass"> {{characterClass.hitDie}} </td>
      </ng-container>

      <ng-container matColumnDef="base-attack-bonus-progression">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>BAB Progression</th>
        <td mat-cell
            *matCellDef="let characterClass"
            matTooltip="Full: BAB increases by 1 for each class level&#13;
                        Three-Quarters: BAB increases by .75 for each class level&#13;
                        Half: BAB increases by .5 for each class level"
            [matTooltipShowDelay]="tooltipDelay.value"> {{this.babDisplayValues.get(characterClass.baseAttackBonusProgression)}} </td>
      </ng-container>

      <ng-container matColumnDef="fort-save-progression">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fort Save Progression</th>
        <td mat-cell *matCellDef="let characterClass"
            matTooltip="Formula:&#13; {{ characterClass.fortSaveProgression === this.goodSavingThrowQuality ?  this.goodSavingThrowFormula : this.badSavingThrowFormula }}"
            [matTooltipShowDelay]="tooltipDelay.value"> {{characterClass.fortSaveProgression | titlecase}} </td>
      </ng-container>

      <ng-container matColumnDef="reflex-save-progression">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Reflex Save Progression</th>
        <td mat-cell *matCellDef="let characterClass"
            matTooltip="Formula:&#13; {{ characterClass.reflexSaveProgression === this.goodSavingThrowQuality ?  this.goodSavingThrowFormula : this.badSavingThrowFormula }}"
            [matTooltipShowDelay]="tooltipDelay.value"> {{characterClass.reflexSaveProgression | titlecase}} </td>
      </ng-container>

      <ng-container matColumnDef="will-save-progression">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Will Save Progression</th>
        <td mat-cell *matCellDef="let characterClass"
            matTooltip="Formula:&#13; {{ characterClass.willSaveProgression === this.goodSavingThrowQuality ?  this.goodSavingThrowFormula : this.badSavingThrowFormula }}"
            [matTooltipShowDelay]="tooltipDelay.value"> {{characterClass.willSaveProgression | titlecase}} </td>
      </ng-container>

      <ng-container matColumnDef="source">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Source</th>
        <td mat-cell *matCellDef="let characterClass"> {{characterClass.source.readable}} </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let characterClass">
          <button mat-icon-button class="add-class-button"
                  (click)="addClass(characterClass)"
                  matTooltip="Add a level of {{ characterClass.name }}"
                  [matTooltipShowDelay]="tooltipDelay.value">
            <mat-icon>add_circle</mat-icon>
          </button>
          <button mat-icon-button class="inspect-class-button"
                  (click)="openDialog(characterClass)"
                  matTooltip="Inspect {{ characterClass.name }} details"
                  [matTooltipShowDelay]="tooltipDelay.value">
            <mat-icon>info</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="this.searchTableColumnsToDisplay; sticky: true"></tr>
      <tr mat-header-row *matHeaderRowDef="displayedColumnFilters"></tr>
      <tr mat-row *matRowDef="let row; columns: this.searchTableColumnsToDisplay;"></tr>

    </table>

    <mat-paginator [pageSizeOptions]="[25, 50, 100]"
                   [color]="'accent'"
                   showFirstLastButtons
                   aria-label="Select page of periodic characterClass">
    </mat-paginator>
  </mat-tab>

  <mat-tab label="Class Levels Selected" [disabled]="this.classLevels.length === 0">

    <table mat-table
           cdkDropList
           [dataSource]="this.classLevelTableDataSource"
           (cdkDropListDropped)="drop($event)"
           [cdkDropListData]="this.classLevelTableDataSource">

      <ng-container matColumnDef="drag">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button >
            <mat-icon cdkDragHandle>drag_indicator</mat-icon>
          </button>
        </td>
      </ng-container>

      <ng-container matColumnDef="level">
        <th mat-header-cell *matHeaderCellDef>Level</th>
        <td mat-cell *matCellDef="let characterClass">{{characterClass.level}}</td>
      </ng-container>

      <ng-container matColumnDef="character-class">
        <th mat-header-cell *matHeaderCellDef>Class</th>
        <td mat-cell *matCellDef="let characterClass">{{characterClass.characterClassName}}</td>
      </ng-container>

      <ng-container matColumnDef="bab-total">
        <th mat-header-cell *matHeaderCellDef>Base Attack Bonus</th>
        <td mat-cell *matCellDef="let characterClass">{{ characterClass.babTotal }}</td>
      </ng-container>

      <ng-container matColumnDef="fort-save-total">
        <th mat-header-cell *matHeaderCellDef>Fort Save</th>
        <td mat-cell *matCellDef="let characterClass">{{ characterClass.fortSaveTotal }}</td>
      </ng-container>

      <ng-container matColumnDef="reflex-save-total">
        <th mat-header-cell *matHeaderCellDef>Reflex Save</th>
        <td mat-cell *matCellDef="let characterClass">{{ characterClass.reflexSaveTotal }}</td>
      </ng-container>

      <ng-container matColumnDef="will-save-total">
        <th mat-header-cell *matHeaderCellDef>Will Save</th>
        <td mat-cell *matCellDef="let characterClass">{{ characterClass.willSaveTotal }}</td>
      </ng-container>

      <ng-container matColumnDef="class-features">
        <th mat-header-cell *matHeaderCellDef>Class Features</th>
        <td mat-cell *matCellDef="let characterClass">{{ characterClass.classFeatures }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let characterClass">
          <button mat-icon-button class="remove-class-button"
                  (click)="removeClass(characterClass)"
                  matTooltip="Remove this level of {{ characterClass.characterClassName }}"
                  [matTooltipShowDelay]="tooltipDelay.value">
            <mat-icon>remove_circle</mat-icon>
          </button>
          <button mat-icon-button class="inspect-class-button"
                  (click)="openDialog(this.findCharacterClassInSearchResultsByName(characterClass.characterClassName))"
                  matTooltip="Inspect {{ characterClass.characterClassName }} details"
                  [matTooltipShowDelay]="tooltipDelay.value">
            <mat-icon>info</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="this.classLevelTableColumnsToDisplay; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: this.classLevelTableColumnsToDisplay;" cdkDragLockAxis="y" cdkDrag></tr>
    </table>

  </mat-tab>

</mat-tab-group>

<button mat-button matStepperPrevious>Back</button>
